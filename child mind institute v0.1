{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "a4da51be",
   "metadata": {
    "_cell_guid": "b1076dfc-b9ad-4769-8c92-a6c4dae69d19",
    "_uuid": "8f2839f25d086af736a60e9eeb907d3b93b6e0e5",
    "execution": {
     "iopub.execute_input": "2025-06-10T23:58:21.780898Z",
     "iopub.status.busy": "2025-06-10T23:58:21.780604Z",
     "iopub.status.idle": "2025-06-10T23:58:23.370383Z",
     "shell.execute_reply": "2025-06-10T23:58:23.369355Z"
    },
    "papermill": {
     "duration": 1.595056,
     "end_time": "2025-06-10T23:58:23.371797",
     "exception": false,
     "start_time": "2025-06-10T23:58:21.776741",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/kaggle/input/cmi-detect-behavior-with-sensor-data/train_demographics.csv\n",
      "/kaggle/input/cmi-detect-behavior-with-sensor-data/test_demographics.csv\n",
      "/kaggle/input/cmi-detect-behavior-with-sensor-data/train.csv\n",
      "/kaggle/input/cmi-detect-behavior-with-sensor-data/test.csv\n",
      "/kaggle/input/cmi-detect-behavior-with-sensor-data/kaggle_evaluation/cmi_inference_server.py\n",
      "/kaggle/input/cmi-detect-behavior-with-sensor-data/kaggle_evaluation/cmi_gateway.py\n",
      "/kaggle/input/cmi-detect-behavior-with-sensor-data/kaggle_evaluation/__init__.py\n",
      "/kaggle/input/cmi-detect-behavior-with-sensor-data/kaggle_evaluation/core/templates.py\n",
      "/kaggle/input/cmi-detect-behavior-with-sensor-data/kaggle_evaluation/core/base_gateway.py\n",
      "/kaggle/input/cmi-detect-behavior-with-sensor-data/kaggle_evaluation/core/relay.py\n",
      "/kaggle/input/cmi-detect-behavior-with-sensor-data/kaggle_evaluation/core/kaggle_evaluation.proto\n",
      "/kaggle/input/cmi-detect-behavior-with-sensor-data/kaggle_evaluation/core/__init__.py\n",
      "/kaggle/input/cmi-detect-behavior-with-sensor-data/kaggle_evaluation/core/generated/kaggle_evaluation_pb2.py\n",
      "/kaggle/input/cmi-detect-behavior-with-sensor-data/kaggle_evaluation/core/generated/kaggle_evaluation_pb2_grpc.py\n",
      "/kaggle/input/cmi-detect-behavior-with-sensor-data/kaggle_evaluation/core/generated/__init__.py\n"
     ]
    }
   ],
   "source": [
    "# This Python 3 environment comes with many helpful analytics libraries installed\n",
    "# It is defined by the kaggle/python Docker image: https://github.com/kaggle/docker-python\n",
    "# For example, here's several helpful packages to load\n",
    "\n",
    "import numpy as np # linear algebra\n",
    "import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)\n",
    "\n",
    "# Input data files are available in the read-only \"../input/\" directory\n",
    "# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n",
    "\n",
    "import os\n",
    "for dirname, _, filenames in os.walk('/kaggle/input'):\n",
    "    for filename in filenames:\n",
    "        print(os.path.join(dirname, filename))\n",
    "\n",
    "# You can write up to 20GB to the current directory (/kaggle/working/) that gets preserved as output when you create a version using \"Save & Run All\" \n",
    "# You can also write temporary files to /kaggle/temp/, but they won't be saved outside of the current session"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "701d715c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-06-10T23:58:23.376620Z",
     "iopub.status.busy": "2025-06-10T23:58:23.376315Z",
     "iopub.status.idle": "2025-06-10T23:58:23.380514Z",
     "shell.execute_reply": "2025-06-10T23:58:23.380026Z"
    },
    "papermill": {
     "duration": 0.007534,
     "end_time": "2025-06-10T23:58:23.381554",
     "exception": false,
     "start_time": "2025-06-10T23:58:23.374020",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class workflow:\n",
    "    train_dataset = []\n",
    "    test_dataset = []\n",
    "    sample_submission = []\n",
    "    input_to_model = []\n",
    "    ground_truth = []\n",
    "    model_prediction = []\n",
    "    model = 0\n",
    "\n",
    "    def __init__(self):\n",
    "        self.load_data()\n",
    "\n",
    "    def load_data(self):\n",
    "        # read csv\n",
    "        competition_file_path = \"/kaggle/input/cmi-detect-behavior-with-sensor-data\"\n",
    "        train_file_path = competition_file_path + \"/train.csv\"\n",
    "        test_file_path = competition_file_path + \"/test.csv\"\n",
    "        \n",
    "        self.train_dataset = pd.read_csv(train_file_path)\n",
    "        self.test_dataset = pd.read_csv(test_file_path)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "8ea26e66",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-06-10T23:58:23.385487Z",
     "iopub.status.busy": "2025-06-10T23:58:23.385307Z",
     "iopub.status.idle": "2025-06-10T23:58:45.930464Z",
     "shell.execute_reply": "2025-06-10T23:58:45.929695Z"
    },
    "papermill": {
     "duration": 22.548756,
     "end_time": "2025-06-10T23:58:45.931921",
     "exception": false,
     "start_time": "2025-06-10T23:58:23.383165",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>row_id</th>\n",
       "      <th>sequence_type</th>\n",
       "      <th>sequence_id</th>\n",
       "      <th>sequence_counter</th>\n",
       "      <th>subject</th>\n",
       "      <th>orientation</th>\n",
       "      <th>behavior</th>\n",
       "      <th>phase</th>\n",
       "      <th>gesture</th>\n",
       "      <th>acc_x</th>\n",
       "      <th>...</th>\n",
       "      <th>tof_5_v54</th>\n",
       "      <th>tof_5_v55</th>\n",
       "      <th>tof_5_v56</th>\n",
       "      <th>tof_5_v57</th>\n",
       "      <th>tof_5_v58</th>\n",
       "      <th>tof_5_v59</th>\n",
       "      <th>tof_5_v60</th>\n",
       "      <th>tof_5_v61</th>\n",
       "      <th>tof_5_v62</th>\n",
       "      <th>tof_5_v63</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>SEQ_000007_000000</td>\n",
       "      <td>Target</td>\n",
       "      <td>SEQ_000007</td>\n",
       "      <td>0</td>\n",
       "      <td>SUBJ_059520</td>\n",
       "      <td>Seated Lean Non Dom - FACE DOWN</td>\n",
       "      <td>Relaxes and moves hand to target location</td>\n",
       "      <td>Transition</td>\n",
       "      <td>Cheek - pinch skin</td>\n",
       "      <td>6.683594</td>\n",
       "      <td>...</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>SEQ_000007_000001</td>\n",
       "      <td>Target</td>\n",
       "      <td>SEQ_000007</td>\n",
       "      <td>1</td>\n",
       "      <td>SUBJ_059520</td>\n",
       "      <td>Seated Lean Non Dom - FACE DOWN</td>\n",
       "      <td>Relaxes and moves hand to target location</td>\n",
       "      <td>Transition</td>\n",
       "      <td>Cheek - pinch skin</td>\n",
       "      <td>6.949219</td>\n",
       "      <td>...</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>SEQ_000007_000002</td>\n",
       "      <td>Target</td>\n",
       "      <td>SEQ_000007</td>\n",
       "      <td>2</td>\n",
       "      <td>SUBJ_059520</td>\n",
       "      <td>Seated Lean Non Dom - FACE DOWN</td>\n",
       "      <td>Relaxes and moves hand to target location</td>\n",
       "      <td>Transition</td>\n",
       "      <td>Cheek - pinch skin</td>\n",
       "      <td>5.722656</td>\n",
       "      <td>...</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>112.0</td>\n",
       "      <td>119.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>SEQ_000007_000003</td>\n",
       "      <td>Target</td>\n",
       "      <td>SEQ_000007</td>\n",
       "      <td>3</td>\n",
       "      <td>SUBJ_059520</td>\n",
       "      <td>Seated Lean Non Dom - FACE DOWN</td>\n",
       "      <td>Relaxes and moves hand to target location</td>\n",
       "      <td>Transition</td>\n",
       "      <td>Cheek - pinch skin</td>\n",
       "      <td>6.601562</td>\n",
       "      <td>...</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>101.0</td>\n",
       "      <td>111.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>SEQ_000007_000004</td>\n",
       "      <td>Target</td>\n",
       "      <td>SEQ_000007</td>\n",
       "      <td>4</td>\n",
       "      <td>SUBJ_059520</td>\n",
       "      <td>Seated Lean Non Dom - FACE DOWN</td>\n",
       "      <td>Relaxes and moves hand to target location</td>\n",
       "      <td>Transition</td>\n",
       "      <td>Cheek - pinch skin</td>\n",
       "      <td>5.566406</td>\n",
       "      <td>...</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>101.0</td>\n",
       "      <td>109.0</td>\n",
       "      <td>125.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>574940</th>\n",
       "      <td>SEQ_065531_000048</td>\n",
       "      <td>Non-Target</td>\n",
       "      <td>SEQ_065531</td>\n",
       "      <td>48</td>\n",
       "      <td>SUBJ_039498</td>\n",
       "      <td>Seated Lean Non Dom - FACE DOWN</td>\n",
       "      <td>Performs gesture</td>\n",
       "      <td>Gesture</td>\n",
       "      <td>Write name on leg</td>\n",
       "      <td>3.503906</td>\n",
       "      <td>...</td>\n",
       "      <td>62.0</td>\n",
       "      <td>65.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>71.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>574941</th>\n",
       "      <td>SEQ_065531_000049</td>\n",
       "      <td>Non-Target</td>\n",
       "      <td>SEQ_065531</td>\n",
       "      <td>49</td>\n",
       "      <td>SUBJ_039498</td>\n",
       "      <td>Seated Lean Non Dom - FACE DOWN</td>\n",
       "      <td>Performs gesture</td>\n",
       "      <td>Gesture</td>\n",
       "      <td>Write name on leg</td>\n",
       "      <td>3.773438</td>\n",
       "      <td>...</td>\n",
       "      <td>71.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>574942</th>\n",
       "      <td>SEQ_065531_000050</td>\n",
       "      <td>Non-Target</td>\n",
       "      <td>SEQ_065531</td>\n",
       "      <td>50</td>\n",
       "      <td>SUBJ_039498</td>\n",
       "      <td>Seated Lean Non Dom - FACE DOWN</td>\n",
       "      <td>Performs gesture</td>\n",
       "      <td>Gesture</td>\n",
       "      <td>Write name on leg</td>\n",
       "      <td>3.082031</td>\n",
       "      <td>...</td>\n",
       "      <td>80.0</td>\n",
       "      <td>77.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>574943</th>\n",
       "      <td>SEQ_065531_000051</td>\n",
       "      <td>Non-Target</td>\n",
       "      <td>SEQ_065531</td>\n",
       "      <td>51</td>\n",
       "      <td>SUBJ_039498</td>\n",
       "      <td>Seated Lean Non Dom - FACE DOWN</td>\n",
       "      <td>Performs gesture</td>\n",
       "      <td>Gesture</td>\n",
       "      <td>Write name on leg</td>\n",
       "      <td>3.964844</td>\n",
       "      <td>...</td>\n",
       "      <td>72.0</td>\n",
       "      <td>77.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>574944</th>\n",
       "      <td>SEQ_065531_000052</td>\n",
       "      <td>Non-Target</td>\n",
       "      <td>SEQ_065531</td>\n",
       "      <td>52</td>\n",
       "      <td>SUBJ_039498</td>\n",
       "      <td>Seated Lean Non Dom - FACE DOWN</td>\n",
       "      <td>Performs gesture</td>\n",
       "      <td>Gesture</td>\n",
       "      <td>Write name on leg</td>\n",
       "      <td>4.269531</td>\n",
       "      <td>...</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>574945 rows × 341 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                   row_id sequence_type sequence_id  sequence_counter  \\\n",
       "0       SEQ_000007_000000        Target  SEQ_000007                 0   \n",
       "1       SEQ_000007_000001        Target  SEQ_000007                 1   \n",
       "2       SEQ_000007_000002        Target  SEQ_000007                 2   \n",
       "3       SEQ_000007_000003        Target  SEQ_000007                 3   \n",
       "4       SEQ_000007_000004        Target  SEQ_000007                 4   \n",
       "...                   ...           ...         ...               ...   \n",
       "574940  SEQ_065531_000048    Non-Target  SEQ_065531                48   \n",
       "574941  SEQ_065531_000049    Non-Target  SEQ_065531                49   \n",
       "574942  SEQ_065531_000050    Non-Target  SEQ_065531                50   \n",
       "574943  SEQ_065531_000051    Non-Target  SEQ_065531                51   \n",
       "574944  SEQ_065531_000052    Non-Target  SEQ_065531                52   \n",
       "\n",
       "            subject                      orientation  \\\n",
       "0       SUBJ_059520  Seated Lean Non Dom - FACE DOWN   \n",
       "1       SUBJ_059520  Seated Lean Non Dom - FACE DOWN   \n",
       "2       SUBJ_059520  Seated Lean Non Dom - FACE DOWN   \n",
       "3       SUBJ_059520  Seated Lean Non Dom - FACE DOWN   \n",
       "4       SUBJ_059520  Seated Lean Non Dom - FACE DOWN   \n",
       "...             ...                              ...   \n",
       "574940  SUBJ_039498  Seated Lean Non Dom - FACE DOWN   \n",
       "574941  SUBJ_039498  Seated Lean Non Dom - FACE DOWN   \n",
       "574942  SUBJ_039498  Seated Lean Non Dom - FACE DOWN   \n",
       "574943  SUBJ_039498  Seated Lean Non Dom - FACE DOWN   \n",
       "574944  SUBJ_039498  Seated Lean Non Dom - FACE DOWN   \n",
       "\n",
       "                                         behavior       phase  \\\n",
       "0       Relaxes and moves hand to target location  Transition   \n",
       "1       Relaxes and moves hand to target location  Transition   \n",
       "2       Relaxes and moves hand to target location  Transition   \n",
       "3       Relaxes and moves hand to target location  Transition   \n",
       "4       Relaxes and moves hand to target location  Transition   \n",
       "...                                           ...         ...   \n",
       "574940                           Performs gesture     Gesture   \n",
       "574941                           Performs gesture     Gesture   \n",
       "574942                           Performs gesture     Gesture   \n",
       "574943                           Performs gesture     Gesture   \n",
       "574944                           Performs gesture     Gesture   \n",
       "\n",
       "                   gesture     acc_x  ...  tof_5_v54  tof_5_v55  tof_5_v56  \\\n",
       "0       Cheek - pinch skin  6.683594  ...       -1.0       -1.0       -1.0   \n",
       "1       Cheek - pinch skin  6.949219  ...       -1.0       -1.0       -1.0   \n",
       "2       Cheek - pinch skin  5.722656  ...       -1.0       -1.0      112.0   \n",
       "3       Cheek - pinch skin  6.601562  ...       -1.0       -1.0      101.0   \n",
       "4       Cheek - pinch skin  5.566406  ...       -1.0       -1.0      101.0   \n",
       "...                    ...       ...  ...        ...        ...        ...   \n",
       "574940   Write name on leg  3.503906  ...       62.0       65.0       -1.0   \n",
       "574941   Write name on leg  3.773438  ...       71.0       72.0       -1.0   \n",
       "574942   Write name on leg  3.082031  ...       80.0       77.0       -1.0   \n",
       "574943   Write name on leg  3.964844  ...       72.0       77.0       -1.0   \n",
       "574944   Write name on leg  4.269531  ...       -1.0       -1.0       -1.0   \n",
       "\n",
       "        tof_5_v57  tof_5_v58  tof_5_v59  tof_5_v60  tof_5_v61  tof_5_v62  \\\n",
       "0            -1.0       -1.0       -1.0       -1.0       -1.0       -1.0   \n",
       "1            -1.0       -1.0       -1.0       -1.0       -1.0       -1.0   \n",
       "2           119.0       -1.0       -1.0       -1.0       -1.0       -1.0   \n",
       "3           111.0       -1.0       -1.0       -1.0       -1.0       -1.0   \n",
       "4           109.0      125.0       -1.0       -1.0       -1.0       -1.0   \n",
       "...           ...        ...        ...        ...        ...        ...   \n",
       "574940       -1.0       -1.0       -1.0       -1.0       -1.0       -1.0   \n",
       "574941       -1.0       -1.0       -1.0       -1.0       -1.0       -1.0   \n",
       "574942       -1.0       -1.0       -1.0       -1.0       -1.0       -1.0   \n",
       "574943       -1.0       -1.0       -1.0       -1.0       -1.0       -1.0   \n",
       "574944       -1.0       -1.0       -1.0       -1.0       -1.0       -1.0   \n",
       "\n",
       "        tof_5_v63  \n",
       "0            -1.0  \n",
       "1            -1.0  \n",
       "2            -1.0  \n",
       "3            -1.0  \n",
       "4            -1.0  \n",
       "...           ...  \n",
       "574940       71.0  \n",
       "574941       -1.0  \n",
       "574942       -1.0  \n",
       "574943       -1.0  \n",
       "574944       -1.0  \n",
       "\n",
       "[574945 rows x 341 columns]"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "workflow_instance = workflow()\n",
    "workflow_instance.train_dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "4d380889",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-06-10T23:58:45.936906Z",
     "iopub.status.busy": "2025-06-10T23:58:45.936670Z",
     "iopub.status.idle": "2025-06-10T23:58:45.958224Z",
     "shell.execute_reply": "2025-06-10T23:58:45.957397Z"
    },
    "papermill": {
     "duration": 0.025154,
     "end_time": "2025-06-10T23:58:45.959327",
     "exception": false,
     "start_time": "2025-06-10T23:58:45.934173",
     "status": "completed"
    },
    "scrolled": true,
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>row_id</th>\n",
       "      <th>sequence_id</th>\n",
       "      <th>sequence_counter</th>\n",
       "      <th>subject</th>\n",
       "      <th>acc_x</th>\n",
       "      <th>acc_y</th>\n",
       "      <th>acc_z</th>\n",
       "      <th>rot_w</th>\n",
       "      <th>rot_x</th>\n",
       "      <th>rot_y</th>\n",
       "      <th>...</th>\n",
       "      <th>tof_5_v54</th>\n",
       "      <th>tof_5_v55</th>\n",
       "      <th>tof_5_v56</th>\n",
       "      <th>tof_5_v57</th>\n",
       "      <th>tof_5_v58</th>\n",
       "      <th>tof_5_v59</th>\n",
       "      <th>tof_5_v60</th>\n",
       "      <th>tof_5_v61</th>\n",
       "      <th>tof_5_v62</th>\n",
       "      <th>tof_5_v63</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>SEQ_000001_000000</td>\n",
       "      <td>SEQ_000001</td>\n",
       "      <td>0</td>\n",
       "      <td>SUBJ_055840</td>\n",
       "      <td>9.039062</td>\n",
       "      <td>5.261719</td>\n",
       "      <td>0.800781</td>\n",
       "      <td>0.367188</td>\n",
       "      <td>-0.397400</td>\n",
       "      <td>-0.629028</td>\n",
       "      <td>...</td>\n",
       "      <td>97.0</td>\n",
       "      <td>87.0</td>\n",
       "      <td>206.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>195.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>111.0</td>\n",
       "      <td>-1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>SEQ_000001_000001</td>\n",
       "      <td>SEQ_000001</td>\n",
       "      <td>1</td>\n",
       "      <td>SUBJ_055840</td>\n",
       "      <td>9.421875</td>\n",
       "      <td>3.460938</td>\n",
       "      <td>-1.113281</td>\n",
       "      <td>0.353882</td>\n",
       "      <td>-0.507141</td>\n",
       "      <td>-0.652710</td>\n",
       "      <td>...</td>\n",
       "      <td>175.0</td>\n",
       "      <td>158.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>211.0</td>\n",
       "      <td>187.0</td>\n",
       "      <td>178.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>SEQ_000001_000002</td>\n",
       "      <td>SEQ_000001</td>\n",
       "      <td>2</td>\n",
       "      <td>SUBJ_055840</td>\n",
       "      <td>10.160156</td>\n",
       "      <td>2.082031</td>\n",
       "      <td>-3.871094</td>\n",
       "      <td>0.384094</td>\n",
       "      <td>-0.532104</td>\n",
       "      <td>-0.639648</td>\n",
       "      <td>...</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>160.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>197.0</td>\n",
       "      <td>177.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>SEQ_000001_000003</td>\n",
       "      <td>SEQ_000001</td>\n",
       "      <td>3</td>\n",
       "      <td>SUBJ_055840</td>\n",
       "      <td>9.773438</td>\n",
       "      <td>1.355469</td>\n",
       "      <td>-4.371094</td>\n",
       "      <td>0.387756</td>\n",
       "      <td>-0.531982</td>\n",
       "      <td>-0.634033</td>\n",
       "      <td>...</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>160.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>197.0</td>\n",
       "      <td>183.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>SEQ_000001_000004</td>\n",
       "      <td>SEQ_000001</td>\n",
       "      <td>4</td>\n",
       "      <td>SUBJ_055840</td>\n",
       "      <td>9.195312</td>\n",
       "      <td>1.011719</td>\n",
       "      <td>-3.222656</td>\n",
       "      <td>0.382751</td>\n",
       "      <td>-0.534180</td>\n",
       "      <td>-0.638367</td>\n",
       "      <td>...</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>163.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>200.0</td>\n",
       "      <td>173.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>102</th>\n",
       "      <td>SEQ_000011_000046</td>\n",
       "      <td>SEQ_000011</td>\n",
       "      <td>46</td>\n",
       "      <td>SUBJ_016452</td>\n",
       "      <td>-4.062500</td>\n",
       "      <td>8.613281</td>\n",
       "      <td>-3.140625</td>\n",
       "      <td>0.362488</td>\n",
       "      <td>0.176758</td>\n",
       "      <td>0.793274</td>\n",
       "      <td>...</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>103</th>\n",
       "      <td>SEQ_000011_000047</td>\n",
       "      <td>SEQ_000011</td>\n",
       "      <td>47</td>\n",
       "      <td>SUBJ_016452</td>\n",
       "      <td>-4.140625</td>\n",
       "      <td>8.535156</td>\n",
       "      <td>-3.410156</td>\n",
       "      <td>0.340637</td>\n",
       "      <td>0.166565</td>\n",
       "      <td>0.799927</td>\n",
       "      <td>...</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>104</th>\n",
       "      <td>SEQ_000011_000048</td>\n",
       "      <td>SEQ_000011</td>\n",
       "      <td>48</td>\n",
       "      <td>SUBJ_016452</td>\n",
       "      <td>-4.214844</td>\n",
       "      <td>8.414062</td>\n",
       "      <td>-3.371094</td>\n",
       "      <td>0.341675</td>\n",
       "      <td>0.169312</td>\n",
       "      <td>0.799316</td>\n",
       "      <td>...</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>105</th>\n",
       "      <td>SEQ_000011_000049</td>\n",
       "      <td>SEQ_000011</td>\n",
       "      <td>49</td>\n",
       "      <td>SUBJ_016452</td>\n",
       "      <td>-4.406250</td>\n",
       "      <td>8.957031</td>\n",
       "      <td>-3.292969</td>\n",
       "      <td>0.241699</td>\n",
       "      <td>0.135437</td>\n",
       "      <td>0.827820</td>\n",
       "      <td>...</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>106</th>\n",
       "      <td>SEQ_000011_000050</td>\n",
       "      <td>SEQ_000011</td>\n",
       "      <td>50</td>\n",
       "      <td>SUBJ_016452</td>\n",
       "      <td>-3.949219</td>\n",
       "      <td>8.457031</td>\n",
       "      <td>-3.371094</td>\n",
       "      <td>0.302368</td>\n",
       "      <td>0.015930</td>\n",
       "      <td>-0.571106</td>\n",
       "      <td>...</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>107 rows × 336 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                row_id sequence_id  sequence_counter      subject      acc_x  \\\n",
       "0    SEQ_000001_000000  SEQ_000001                 0  SUBJ_055840   9.039062   \n",
       "1    SEQ_000001_000001  SEQ_000001                 1  SUBJ_055840   9.421875   \n",
       "2    SEQ_000001_000002  SEQ_000001                 2  SUBJ_055840  10.160156   \n",
       "3    SEQ_000001_000003  SEQ_000001                 3  SUBJ_055840   9.773438   \n",
       "4    SEQ_000001_000004  SEQ_000001                 4  SUBJ_055840   9.195312   \n",
       "..                 ...         ...               ...          ...        ...   \n",
       "102  SEQ_000011_000046  SEQ_000011                46  SUBJ_016452  -4.062500   \n",
       "103  SEQ_000011_000047  SEQ_000011                47  SUBJ_016452  -4.140625   \n",
       "104  SEQ_000011_000048  SEQ_000011                48  SUBJ_016452  -4.214844   \n",
       "105  SEQ_000011_000049  SEQ_000011                49  SUBJ_016452  -4.406250   \n",
       "106  SEQ_000011_000050  SEQ_000011                50  SUBJ_016452  -3.949219   \n",
       "\n",
       "        acc_y     acc_z     rot_w     rot_x     rot_y  ...  tof_5_v54  \\\n",
       "0    5.261719  0.800781  0.367188 -0.397400 -0.629028  ...       97.0   \n",
       "1    3.460938 -1.113281  0.353882 -0.507141 -0.652710  ...      175.0   \n",
       "2    2.082031 -3.871094  0.384094 -0.532104 -0.639648  ...       -1.0   \n",
       "3    1.355469 -4.371094  0.387756 -0.531982 -0.634033  ...       -1.0   \n",
       "4    1.011719 -3.222656  0.382751 -0.534180 -0.638367  ...       -1.0   \n",
       "..        ...       ...       ...       ...       ...  ...        ...   \n",
       "102  8.613281 -3.140625  0.362488  0.176758  0.793274  ...       -1.0   \n",
       "103  8.535156 -3.410156  0.340637  0.166565  0.799927  ...       -1.0   \n",
       "104  8.414062 -3.371094  0.341675  0.169312  0.799316  ...       -1.0   \n",
       "105  8.957031 -3.292969  0.241699  0.135437  0.827820  ...       -1.0   \n",
       "106  8.457031 -3.371094  0.302368  0.015930 -0.571106  ...       -1.0   \n",
       "\n",
       "     tof_5_v55  tof_5_v56  tof_5_v57  tof_5_v58  tof_5_v59  tof_5_v60  \\\n",
       "0         87.0      206.0       -1.0      195.0       -1.0       -1.0   \n",
       "1        158.0       -1.0       -1.0       -1.0       -1.0       -1.0   \n",
       "2        160.0       -1.0       -1.0       -1.0       -1.0       -1.0   \n",
       "3        160.0       -1.0       -1.0       -1.0       -1.0       -1.0   \n",
       "4        163.0       -1.0       -1.0       -1.0       -1.0       -1.0   \n",
       "..         ...        ...        ...        ...        ...        ...   \n",
       "102       -1.0       -1.0       -1.0       -1.0       -1.0       -1.0   \n",
       "103       -1.0       -1.0       -1.0       -1.0       -1.0       -1.0   \n",
       "104       -1.0       -1.0       -1.0       -1.0       -1.0       -1.0   \n",
       "105       -1.0       -1.0       -1.0       -1.0       -1.0       -1.0   \n",
       "106       -1.0       -1.0       -1.0       -1.0       -1.0       -1.0   \n",
       "\n",
       "     tof_5_v61  tof_5_v62  tof_5_v63  \n",
       "0         -1.0      111.0       -1.0  \n",
       "1        211.0      187.0      178.0  \n",
       "2         -1.0      197.0      177.0  \n",
       "3         -1.0      197.0      183.0  \n",
       "4         -1.0      200.0      173.0  \n",
       "..         ...        ...        ...  \n",
       "102       -1.0       -1.0       -1.0  \n",
       "103       -1.0       -1.0       -1.0  \n",
       "104       -1.0       -1.0       -1.0  \n",
       "105       -1.0       -1.0       -1.0  \n",
       "106       -1.0       -1.0       -1.0  \n",
       "\n",
       "[107 rows x 336 columns]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#columns = workflow_instance.test_dataset.columns\n",
    "#for i in columns:\n",
    "#    print(i)\n",
    "workflow_instance.test_dataset"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c795b632",
   "metadata": {
    "papermill": {
     "duration": 0.001823,
     "end_time": "2025-06-10T23:58:45.963578",
     "exception": false,
     "start_time": "2025-06-10T23:58:45.961755",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### Finding format for submission\n",
    "\n",
    "In the competiton details, we are told that the sample_submission is sequence_id and gesture.\n",
    "\n",
    "So we can see that the gesture, sequence_type and orientation are missing from the test data but we only have to predict gesture\n",
    "\n",
    "The easiest thing to do would be to remove the sequence_type and orientation from the test dataset but I wonder if I can feature encode them somehow."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "58e355e3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-06-10T23:58:45.968846Z",
     "iopub.status.busy": "2025-06-10T23:58:45.968500Z",
     "iopub.status.idle": "2025-06-10T23:58:46.025704Z",
     "shell.execute_reply": "2025-06-10T23:58:46.024974Z"
    },
    "papermill": {
     "duration": 0.061844,
     "end_time": "2025-06-10T23:58:46.027388",
     "exception": false,
     "start_time": "2025-06-10T23:58:45.965544",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['Cheek - pinch skin' 'Forehead - pull hairline' 'Write name on leg'\n",
      " 'Feel around in tray and pull out an object' 'Neck - scratch'\n",
      " 'Neck - pinch skin' 'Eyelash - pull hair' 'Eyebrow - pull hair'\n",
      " 'Forehead - scratch' 'Above ear - pull hair' 'Wave hello'\n",
      " 'Write name in air' 'Text on phone' 'Pull air toward your face'\n",
      " 'Pinch knee/leg skin' 'Scratch knee/leg skin' 'Drink from bottle/cup'\n",
      " 'Glasses on/off']\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "(18,)"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "print(workflow_instance.train_dataset[\"gesture\"].unique())\n",
    "np.shape(workflow_instance.train_dataset[\"gesture\"].unique())"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9270c635",
   "metadata": {
    "papermill": {
     "duration": 0.001934,
     "end_time": "2025-06-10T23:58:46.031892",
     "exception": false,
     "start_time": "2025-06-10T23:58:46.029958",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Investigating which type of model that I need\n",
    "\n",
    "We can see that there are 18 different \"classes\" of gestures that are possible, we can assume that they are mutually exclusive.\n",
    "- Although there are some for the same part of the body (e.g Forehead)\n",
    "- I wonder if it would be best to encode that into the classification somehow\n",
    "\n",
    "This means that I need a binary classification model                               "
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "databundleVersionId": 12518947,
     "sourceId": 102335,
     "sourceType": "competition"
    }
   ],
   "dockerImageVersionId": 31040,
   "isGpuEnabled": false,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.11"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 30.053281,
   "end_time": "2025-06-10T23:58:46.753113",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2025-06-10T23:58:16.699832",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
